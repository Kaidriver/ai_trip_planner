import{_ as H}from"./D_c9pnaL.js";import{e as V,f as P,r as T,s as S,g as $,h as U,i as z,j as F,k as N,l as I,m as f,n as G,p as K,q as A,v as x,x as W,y as J,z as Y,A as Q,B as X,c as p,a as e,C as k,b as Z,w as ee,F as B,D as L,t as _,E as te,o as v,_ as ae}from"./gfc1jKLV.js";import{h as se}from"./DY7prswQ.js";const ne=""+new URL("loading-animation.BOH6lbMD.webm",import.meta.url).href,oe=o=>o==="defer"||o===!1;function re(...o){var O;const c=typeof o[o.length-1]=="string"?o.pop():void 0;typeof o[0]!="string"&&o.unshift(c);let[s,r,t={}]=o;if(typeof s!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof r!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const a=V(),y=r,m=()=>P.value,i=()=>a.isHydrating?a.payload.data[s]:a.static.data[s];t.server=t.server??!0,t.default=t.default??m,t.getCachedData=t.getCachedData??i,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0,t.deep=t.deep??P.deep,t.dedupe=t.dedupe??"cancel";const g=t.getCachedData(s,a),h=g!=null;if(!a._asyncData[s]||!t.immediate){(O=a.payload._errors)[s]??(O[s]=P.errorValue);const u=t.deep?T:S;a._asyncData[s]={data:u(h?g:t.default()),pending:T(!h),error:$(a.payload._errors,s),status:T("idle"),_default:t.default}}const d={...a._asyncData[s]};delete d._default,d.refresh=d.execute=(u={})=>{if(a._asyncDataPromises[s]){if(oe(u.dedupe??t.dedupe))return a._asyncDataPromises[s];a._asyncDataPromises[s].cancelled=!0}if(u._initial||a.isHydrating&&u._initial!==!1){const l=u._initial?g:t.getCachedData(s,a);if(l!=null)return Promise.resolve(l)}d.pending.value=!0,d.status.value="pending";const b=new Promise((l,n)=>{try{l(y(a))}catch(q){n(q)}}).then(async l=>{if(b.cancelled)return a._asyncDataPromises[s];let n=l;t.transform&&(n=await t.transform(l)),t.pick&&(n=de(n,t.pick)),a.payload.data[s]=n,d.data.value=n,d.error.value=P.errorValue,d.status.value="success"}).catch(l=>{if(b.cancelled)return a._asyncDataPromises[s];d.error.value=I(l),d.data.value=f(t.default()),d.status.value="error"}).finally(()=>{b.cancelled||(d.pending.value=!1,delete a._asyncDataPromises[s])});return a._asyncDataPromises[s]=b,a._asyncDataPromises[s]},d.clear=()=>ie(a,s);const E=()=>d.refresh({_initial:!0}),w=t.server!==!1&&a.payload.serverRendered;{const u=G();if(u&&w&&t.immediate&&!u.sp&&(u.sp=[]),u&&!u._nuxtOnBeforeMountCbs){u._nuxtOnBeforeMountCbs=[];const n=u._nuxtOnBeforeMountCbs;U(()=>{n.forEach(q=>{q()}),n.splice(0,n.length)}),z(()=>n.splice(0,n.length))}w&&a.isHydrating&&(d.error.value||g!=null)?(d.pending.value=!1,d.status.value=d.error.value?"error":"success"):u&&(a.payload.serverRendered&&a.isHydrating||t.lazy)&&t.immediate?u._nuxtOnBeforeMountCbs.push(E):t.immediate&&E();const b=K();if(t.watch){const n=F(t.watch,()=>d.refresh());b&&N(n)}const l=a.hook("app:data:refresh",async n=>{(!n||n.includes(s))&&await d.refresh()});b&&N(l)}const C=Promise.resolve(a._asyncDataPromises[s]).then(()=>d);return Object.assign(C,d),C}function ie(o,c){c in o.payload.data&&(o.payload.data[c]=void 0),c in o.payload._errors&&(o.payload._errors[c]=P.errorValue),o._asyncData[c]&&(o._asyncData[c].data.value=void 0,o._asyncData[c].error.value=P.errorValue,o._asyncData[c].pending.value=!1,o._asyncData[c].status.value="idle"),c in o._asyncDataPromises&&(o._asyncDataPromises[c]&&(o._asyncDataPromises[c].cancelled=!0),o._asyncDataPromises[c]=void 0)}function de(o,c){const s={};for(const r of c)s[r]=o[r];return s}function ce(o,c,s){const[r={},t]=typeof c=="string"?[{},c]:[c,s],a=A(()=>x(o)),y=r.key||se([t,typeof a.value=="string"?a.value:"",...le(r)]);if(!y||typeof y!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+y);if(!o)throw new Error("[nuxt] [useFetch] request is missing.");const m=y===t?"$f"+y:y;if(!r.baseURL&&typeof a.value=="string"&&a.value[0]==="/"&&a.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:i,lazy:g,default:h,transform:d,pick:E,watch:w,immediate:C,getCachedData:O,deep:u,dedupe:b,...l}=r,n=W({...J,...l,cache:typeof r.cache=="boolean"?void 0:r.cache}),q={server:i,lazy:g,default:h,transform:d,pick:E,immediate:C,getCachedData:O,deep:u,dedupe:b,watch:w===!1?[]:[n,a,...w||[]]};let D;return re(m,()=>{var M;(M=D==null?void 0:D.abort)==null||M.call(D,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),D=typeof AbortController<"u"?new AbortController:{};const j=x(r.timeout);let R;return j&&(R=setTimeout(()=>D.abort(new DOMException("Request aborted due to timeout.","AbortError")),j),D.signal.onabort=()=>clearTimeout(R)),(r.$fetch||globalThis.$fetch)(a.value,{signal:D.signal,...n}).finally(()=>{clearTimeout(R)})},q)}function le(o){var s;const c=[((s=x(o.method))==null?void 0:s.toUpperCase())||"GET",x(o.baseURL)];for(const r of[o.params||o.query]){const t=x(r);if(!t)continue;const a={};for(const[y,m]of Object.entries(t))a[x(y)]=x(m);c.push(a)}return c}const ue={class:"container"},fe={key:0,class:"loading-animation"},he={key:1,class:"error-message"},_e={class:"return-btn"},me={key:2,class:"row content-block"},ye={class:"days-display"},pe=["onClick"],ve={class:"col-md-3 meals-col agenda-col"},be={class:"card"},ge={class:"card-body"},De={class:"card-subtitle mb-2 text-muted"},we={class:"card-text"},xe={class:"card"},Ee={class:"card-body"},Ce={class:"card-subtitle mb-2 text-muted"},Oe={class:"card-text"},Pe={class:"card"},Te={class:"card-body"},qe={class:"card-subtitle mb-2 text-muted"},Be={class:"card-text"},Le={class:"col-md-6 activities-col agenda-col"},Re={class:"row"},ke={class:"col-md-6"},je={class:"card"},Me={class:"card-body"},Ne={class:"card-title"},Fe={class:"card-text"},He={class:"row"},Ve={class:"col-md-6"},Se={class:"card"},$e={class:"card-body"},Ue={class:"card-title"},ze={class:"card-text"},Ie={class:"row"},Ge={class:"col-md-6"},Ke={class:"card"},Ae={class:"card-body"},We={class:"card-title"},Je={class:"card-text"},Ye={class:"col-md-3 agenda-col"},Qe={class:"card"},Xe={class:"card-body"},Ze={class:"card-subtitle mb-2 text-muted"},et={class:"card-text"},tt=Y({__name:"agenda",setup(o){const c=te(),s=T([]),r=T({}),t=T(""),a=Q();function y(m){return new Promise(i=>setTimeout(i,m))}return X(async()=>{if(Object.hasOwn(a.query,"destination")&&Object.hasOwn(a.query,"budget")&&Object.hasOwn(a.query,"activityLevel")&&Object.hasOwn(a.query,"radiusMiles")&&Object.hasOwn(a.query,"numDays")){t.value="loading";const{data:m,status:i,error:g,refresh:h,clear:d}=await ce(c.public.prod_endpoint,{method:"GET",query:a.query,headers:{"x-api-key":c.public.secret}},"$e0duEJygyY");if(g.value!=null)t.value="error";else{s.value=m.value,r.value=s.value[0],t.value="startLoading";let w=("Welcome to "+a.query.destination).split("").map(l=>{let n=document.createElement("span");return n.appendChild(document.createTextNode(l)),n.style.display="hidden",n}),C=document.getElementById("header-text");await(async()=>{for(let l=0;l<w.length;l++){let n=w[l];C.append(n),n.style.display="initial",await y(85)}})();let O="Here is your "+s.value.length+" day itinerary";console.log(s);let u=O.split("").map(l=>{let n=document.createElement("span");return n.appendChild(document.createTextNode(l)),n.style.display="hidden",n}),b=document.getElementById("sub-header-text");await(async()=>{for(let l=0;l<u.length;l++){let n=u[l];b.append(n),n.style.display="initial",await y(85)}})(),t.value="loaded"}}else t.value="error"}),F(r,()=>{document.querySelectorAll(".agenda-col").forEach(m=>{m.classList.remove("col-transition"),m.offsetWidth,m.classList.add("col-transition")})}),(m,i)=>{const g=H;return v(),p("div",ue,[f(t)=="loading"?(v(),p("div",fe,i[0]||(i[0]=[e("video",{autoplay:""},[e("source",{src:ne,type:"video/webm"})],-1),e("h5",null,"Generating...",-1)]))):k("",!0),f(t)=="error"?(v(),p("div",he,[i[2]||(i[2]=e("h1",null,"Error Loading Agenda",-1)),e("div",_e,[Z(g,{to:"/"},{default:ee(()=>i[1]||(i[1]=[e("button",{type:"button",class:"btn error-button"},"Return Home",-1)])),_:1})])])):k("",!0),i[10]||(i[10]=e("h1",{id:"header-text"},null,-1)),i[11]||(i[11]=e("h1",{id:"sub-header-text"},null,-1)),f(t)=="loaded"?(v(),p("div",me,[e("div",ye,[(v(!0),p(B,null,L(f(s),(h,d)=>(v(),p("h5",{onClick:E=>r.value=f(s)[d]},"Day "+_(d+1),9,pe))),256))]),e("div",ve,[e("div",be,[e("div",ge,[i[3]||(i[3]=e("h5",{class:"card-title"},"Breakfast",-1)),e("h6",De,_(f(r).breakfast.name),1),e("p",we,_(f(r).breakfast.description),1)])]),e("div",xe,[e("div",Ee,[i[4]||(i[4]=e("h5",{class:"card-title"},"Lunch",-1)),e("h6",Ce,_(f(r).lunch.name),1),e("p",Oe,_(f(r).lunch.description),1)])]),e("div",Pe,[e("div",Te,[i[5]||(i[5]=e("h5",{class:"card-title"},"Dinner",-1)),e("h6",qe,_(f(r).dinner.name),1),e("p",Be,_(f(r).dinner.description),1)])])]),e("div",Le,[e("div",Re,[i[6]||(i[6]=e("h5",{class:"activities-header"},"Morning",-1)),(v(!0),p(B,null,L(f(r).morningActivities,h=>(v(),p("div",ke,[e("div",je,[e("div",Me,[e("h5",Ne,_(h.name),1),e("p",Fe,_(h.description),1)])])]))),256))]),e("div",He,[i[7]||(i[7]=e("h5",{class:"activities-header"},"Afternoon",-1)),(v(!0),p(B,null,L(f(r).afternoonActivities,h=>(v(),p("div",Ve,[e("div",Se,[e("div",$e,[e("h5",Ue,_(h.name),1),e("p",ze,_(h.description),1)])])]))),256))]),e("div",Ie,[i[8]||(i[8]=e("h5",{class:"activities-header"},"Night",-1)),(v(!0),p(B,null,L(f(r).nightActivities,h=>(v(),p("div",Ge,[e("div",Ke,[e("div",Ae,[e("h5",We,_(h.name),1),e("p",Je,_(h.description),1)])])]))),256))])]),e("div",Ye,[e("div",Qe,[e("div",Xe,[i[9]||(i[9]=e("h5",{class:"card-title"},"Hotel",-1)),e("h6",Ze,_(f(r).hotel.name),1),e("p",et,_(f(r).hotel.description),1)])])])])):k("",!0)])}}}),it=ae(tt,[["__scopeId","data-v-3f5fd438"]]);export{it as default};
